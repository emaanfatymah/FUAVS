{% extends "base.html" %}

{% block content %}
<div class="container back-image">
  <h1 class="mt-5 text-danger text-center">
    Drone Video Feed For Hand Gestures
  </h1>
  <div class="d-flex justify-content-center">
    <img id="droneVideo" src="{{ url_for('handgesture_control.drone_video') }}" alt="Drone Video" class="w-75">
    <img id="laptopVideo" src="{{ url_for('handgesture_control.handgesture_video_feed') }}" alt="Laptop Camera Video"
      class="w-25 ms-2">
  </div>
  <div class="d-flex justify-content-center mt-3">
    <button id="captureImageBtn" class="button is-info fs-3 me-2">Capture Image</button>
    <button id="startRecordingBtn" class="button is-success fs-3 me-2">Start Recording</button>
    <button id="stopRecordingBtn" class="button is-warning fs-3 me-2">Stop Recording</button>
    <button id="stopTrackingBtn" class="button is-danger fs-3 me-2">Stop Hand Gestures</button>
    <button id="backBtn" class="button is-primary fs-3">Back</button>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      var captureImageBtn = document.getElementById("captureImageBtn");
      var startRecordingBtn = document.getElementById("startRecordingBtn");
      var stopRecordingBtn = document.getElementById("stopRecordingBtn");
      var stopTrackingBtn = document.getElementById("stopTrackingBtn");
      var droneVideo = document.getElementById("droneVideo");
      var laptopVideo = document.getElementById("laptopVideo");
      var backBtn = document.getElementById("backBtn");

      captureImageBtn.addEventListener("click", function () {
        fetch("{{ url_for('handgesture_control.capture_image') }}")
          .then(response => response.text())
          .then(data => {
            alert(data);
          })
          .catch(error => console.error('Error:', error));
      });

      startRecordingBtn.addEventListener("click", function () {
        fetch("{{ url_for('handgesture_control.start_recording') }}")
          .then(response => response.text())
          .then(data => {
            alert(data);
          })
          .catch(error => console.error('Error:', error));
      });

      stopRecordingBtn.addEventListener("click", function () {
        fetch("{{ url_for('handgesture_control.stop_recording') }}")
          .then(response => response.text())
          .then(data => {
            alert(data);
          })
          .catch(error => console.error('Error:', error));
      });

      stopTrackingBtn.addEventListener("click", function () {
        fetch("{{ url_for('handgesture_control.stop_handgesture') }}")
          .then(response => response.text())
          .then(data => {
            console.log(data);
            droneVideo.src = "";
            laptopVideo.src = "";
            alert('Hand gestures tracking stopped.');
          })
          .catch(error => console.error('Error:', error));
      });

      backBtn.addEventListener("click", function () {
        fetch("{{ url_for('handgesture_control.disconnect_to_handgesture') }}")
          .then(response => response.text())
          .then(data => {
            window.location.href = "{{ url_for('main.profile') }}";
          })
          .catch(error => console.error('Error:', error));
      });
    });
  </script>
</div>
{% endblock %}